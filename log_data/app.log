2025-08-28 15:17:24.999000+00:00| INFO | __main__ | System starting.
2025-08-28 15:17:25.006000+00:00| INFO | clickhouse | Creating ticks_db table.
2025-08-28 15:17:25.185000+00:00| INFO | clickhouse | ticks_db table created successfully.
2025-08-28 15:17:25.186000+00:00| INFO | clickhouse | Creating websocket_diagnostics table.
2025-08-28 15:17:25.259000+00:00| INFO | clickhouse | websocket_diagnostics table created successfully.
2025-08-28 15:17:25.260000+00:00| INFO | clickhouse | Creating processing_diagnostics table.
2025-08-28 15:17:25.268000+00:00| INFO | clickhouse | processing_diagnostics table created successfully.
2025-08-28 15:17:25.268000+00:00| INFO | clickhouse | Creating monitoring_db table.
2025-08-28 15:17:25.316000+00:00| INFO | clickhouse | monitoring_db table created successfully.
2025-08-28 15:17:25.316000+00:00| INFO | clickhouse | Creating uptime_db table.
2025-08-28 15:17:25.347000+00:00| INFO | clickhouse | uptime_db table created successfully.
2025-08-28 15:17:25.394000+00:00| INFO | kafka_producer | Producer thread started.
2025-08-28 15:17:25.455000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=159.65.41.22:9092 <connecting> [IPv4 ('159.65.41.22', 9092)]>: connecting to 159.65.41.22:9092 [('159.65.41.22', 9092) IPv4]
2025-08-28 15:17:25.467000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=159.65.41.22:9092 <checking_api_versions_recv> [IPv4 ('159.65.41.22', 9092)]>: Broker version identified as 2.6
2025-08-28 15:17:25.467000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=159.65.41.22:9092 <connected> [IPv4 ('159.65.41.22', 9092)]>: Connection complete.
2025-08-28 15:17:25.474000+00:00| INFO | kafka.consumer.subscription_state | Updating subscribed topics to: ('price_ticks',)
2025-08-28 15:17:25.475000+00:00| INFO | kafka_consumer | Kafka consumer started.
2025-08-28 15:17:25.501000+00:00| INFO | websocket | Websocket connected
2025-08-28 15:17:25.502000+00:00| INFO | kafka_producer | WebSocket connected.
2025-08-28 15:17:25.503000+00:00| INFO | kafka_producer | Subscribing to BINANCE:ETHUSDT
2025-08-28 15:17:25.583000+00:00| WARNING | kafka.cluster | Topic price_ticks is not available during auto-create initialization
2025-08-28 15:17:25.585000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=159.65.41.22:9092 <connecting> [IPv4 ('159.65.41.22', 9092)]>: connecting to 159.65.41.22:9092 [('159.65.41.22', 9092) IPv4]
2025-08-28 15:17:25.586000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=159.65.41.22:9092 <connected> [IPv4 ('159.65.41.22', 9092)]>: Connection complete.
2025-08-28 15:17:25.586000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=159.65.41.22:9092 <connected> [IPv4 ('159.65.41.22', 9092)]>: Closing connection. 
2025-08-28 15:17:26.507000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=159.65.41.22:9092 <connecting> [IPv4 ('159.65.41.22', 9092)]>: connecting to 159.65.41.22:9092 [('159.65.41.22', 9092) IPv4]
2025-08-28 15:17:26.508000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=159.65.41.22:9092 <connected> [IPv4 ('159.65.41.22', 9092)]>: Connection complete.
2025-08-28 15:17:26.509000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=159.65.41.22:9092 <connected> [IPv4 ('159.65.41.22', 9092)]>: Closing connection. 
2025-08-28 15:17:27.592000+00:00| INFO | kafka.cluster | Coordinator for group/ticks_ingestor is BrokerMetadata(nodeId='coordinator-1', host='159.65.41.22', port=9092, rack=None)
2025-08-28 15:17:27.592000+00:00| INFO | kafka.coordinator | Discovered coordinator coordinator-1 for group ticks_ingestor
2025-08-28 15:17:27.593000+00:00| INFO | kafka.coordinator.heartbeat | Starting new heartbeat thread
2025-08-28 15:17:27.593000+00:00| INFO | kafka.coordinator.consumer | Revoking previously assigned partitions set() for group ticks_ingestor
2025-08-28 15:17:27.594000+00:00| INFO | kafka.coordinator | Failed to join group ticks_ingestor: NodeNotReadyError: coordinator-1
2025-08-28 15:17:27.594000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=coordinator-1 host=159.65.41.22:9092 <connecting> [IPv4 ('159.65.41.22', 9092)]>: connecting to 159.65.41.22:9092 [('159.65.41.22', 9092) IPv4]
2025-08-28 15:17:27.595000+00:00| INFO | kafka.conn | <BrokerConnection client_id=kafka-python-2.2.15, node_id=coordinator-1 host=159.65.41.22:9092 <connected> [IPv4 ('159.65.41.22', 9092)]>: Connection complete.
2025-08-28 15:17:27.696000+00:00| INFO | kafka.coordinator | (Re-)joining group ticks_ingestor
2025-08-28 15:17:27.737000+00:00| INFO | kafka.coordinator | Received member id kafka-python-2.2.15-0abfbc52-c39e-419b-91c2-eed5b7575d5d for group ticks_ingestor; will retry join-group
2025-08-28 15:17:27.737000+00:00| INFO | kafka.coordinator | Failed to join group ticks_ingestor: [Error 79] MemberIdRequiredError
2025-08-28 15:17:27.737000+00:00| INFO | kafka.coordinator | (Re-)joining group ticks_ingestor
2025-08-28 15:17:30.536000+00:00| WARNING | monitoring | No messages received in the last ticks monitoring cycle.
2025-08-28 15:17:30.537000+00:00| INFO | monitoring | Inserted ticks monitoring data for 0 messages.
2025-08-28 15:17:30.781000+00:00| INFO | kafka.coordinator | Successfully joined group ticks_ingestor <Generation 1 (member_id: kafka-python-2.2.15-0abfbc52-c39e-419b-91c2-eed5b7575d5d, protocol: range)>
2025-08-28 15:17:30.781000+00:00| INFO | kafka.coordinator | Elected group leader -- performing partition assignments using range
2025-08-28 15:17:30.781000+00:00| WARNING | kafka.coordinator.assignors.range | No partition metadata for topic price_ticks
2025-08-28 15:17:30.835000+00:00| INFO | kafka.consumer.subscription_state | Updated partition assignment: []
2025-08-28 15:17:30.835000+00:00| INFO | kafka.coordinator.consumer | Setting newly assigned partitions set() for group ticks_ingestor
2025-08-28 15:17:30.976000+00:00| INFO | kafka.coordinator.consumer | Revoking previously assigned partitions set() for group ticks_ingestor
2025-08-28 15:17:30.976000+00:00| INFO | kafka.coordinator | (Re-)joining group ticks_ingestor
2025-08-28 15:17:30.986000+00:00| INFO | kafka.coordinator | Successfully joined group ticks_ingestor <Generation 2 (member_id: kafka-python-2.2.15-0abfbc52-c39e-419b-91c2-eed5b7575d5d, protocol: range)>
2025-08-28 15:17:30.986000+00:00| INFO | kafka.coordinator | Elected group leader -- performing partition assignments using range
2025-08-28 15:17:30.998000+00:00| INFO | kafka.consumer.subscription_state | Updated partition assignment: [TopicPartition(topic='price_ticks', partition=0)]
2025-08-28 15:17:30.998000+00:00| INFO | kafka.coordinator.consumer | Setting newly assigned partitions {TopicPartition(topic='price_ticks', partition=0)} for group ticks_ingestor
2025-08-28 15:17:31.036000+00:00| INFO | kafka.consumer.fetcher | Resetting offset for partition TopicPartition(topic='price_ticks', partition=0) to offset 238.
2025-08-28 15:17:31.459000+00:00| INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:17:31.576000+00:00| INFO | kafka_consumer | Inserted 1 rows to ticks_db.
2025-08-28 15:17:32.576000+00:00| INFO | kafka_consumer | Inserted 10 rows to ticks_db.
2025-08-28 15:17:33.552000+00:00| INFO | kafka_consumer | Inserted 53 rows to ticks_db.
2025-08-28 15:17:35.695000+00:00| INFO | kafka_consumer | Inserted 27 rows to ticks_db.
2025-08-28 15:17:35.988000+00:00| INFO | monitoring | Inserted ticks monitoring data for 64 messages.
2025-08-28 15:17:36.642000+00:00| INFO | kafka_consumer | Inserted 76 rows to ticks_db.
2025-08-28 15:17:36.654000+00:00| INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:17:37.717000+00:00| INFO | kafka_consumer | Inserted 93 rows to ticks_db.
2025-08-28 15:17:37.883000+00:00| INFO | cloud_migration | Written Parquet files: parquet_data/ticks.parquet and parquet_data/ticks_20250828_151735.parquet
2025-08-28 15:17:37.946000+00:00| INFO | cloud_migration | Written Parquet files: parquet_data/ws_diagnostics.parquet and parquet_data/ws_diagnostics_20250828_151735.parquet
2025-08-28 15:17:37.997000+00:00| INFO | cloud_migration | Written Parquet files: parquet_data/proc_diagnostics.parquet and parquet_data/proc_diagnostics_20250828_151735.parquet
2025-08-28 15:17:38.038000+00:00| INFO | cloud_migration | Written Parquet files: parquet_data/monitoring.parquet and parquet_data/monitoring_20250828_151735.parquet
2025-08-28 15:17:38.078000+00:00| INFO | cloud_migration | Written Parquet files: parquet_data/uptime.parquet and parquet_data/uptime_20250828_151735.parquet
2025-08-28 15:17:38,137 | INFO | cloud_migration | Migrated 124 log rows to parquet_data/logs.parquet and parquet_data/logs_20250828_151735.parquet
2025-08-28 15:17:38,139 | INFO | cloud_migration | Uploaded parquet_data/ws_diagnostics_20250828_151735.parquet to S3 at archived_data/ws_diagnostics_20250828_151735.parquet
2025-08-28 15:17:38,140 | INFO | cloud_migration | Uploaded parquet_data/uptime_20250828_151735.parquet to S3 at archived_data/uptime_20250828_151735.parquet
2025-08-28 15:17:38,140 | INFO | cloud_migration | Uploaded parquet_data/proc_diagnostics_20250828_151735.parquet to S3 at archived_data/proc_diagnostics_20250828_151735.parquet
2025-08-28 15:17:38,141 | INFO | cloud_migration | Uploaded parquet_data/monitoring_20250828_151735.parquet to S3 at archived_data/monitoring_20250828_151735.parquet
2025-08-28 15:17:38,141 | INFO | cloud_migration | Uploaded parquet_data/logs_20250828_151735.parquet to S3 at archived_data/logs_20250828_151735.parquet
2025-08-28 15:17:38,142 | INFO | cloud_migration | Uploaded parquet_data/ticks_20250828_151735.parquet to S3 at archived_data/ticks_20250828_151735.parquet
2025-08-28 15:17:38,590 | INFO | kafka_consumer | Inserted 2 rows to ticks_db.
2025-08-28 15:17:39,611 | INFO | kafka_consumer | Inserted 42 rows to ticks_db.
2025-08-28 15:17:40,614 | INFO | kafka_consumer | Inserted 84 rows to ticks_db.
2025-08-28 15:17:41,086 | INFO | monitoring | Inserted ticks monitoring data for 297 messages.
2025-08-28 15:17:41,598 | INFO | kafka_consumer | Inserted 77 rows to ticks_db.
2025-08-28 15:17:41,713 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:17:43,616 | INFO | kafka_consumer | Inserted 36 rows to ticks_db.
2025-08-28 15:17:44,602 | INFO | kafka_consumer | Inserted 56 rows to ticks_db.
2025-08-28 15:17:45,628 | INFO | kafka_consumer | Inserted 33 rows to ticks_db.
2025-08-28 15:17:46,200 | INFO | monitoring | Inserted ticks monitoring data for 202 messages.
2025-08-28 15:17:46,633 | INFO | kafka_consumer | Inserted 96 rows to ticks_db.
2025-08-28 15:17:46,758 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:17:47,642 | INFO | kafka_consumer | Inserted 70 rows to ticks_db.
2025-08-28 15:17:48,609 | INFO | kafka_consumer | Inserted 99 rows to ticks_db.
2025-08-28 15:17:50,598 | INFO | kafka_consumer | Inserted 1 rows to ticks_db.
2025-08-28 15:17:51,277 | INFO | monitoring | Inserted ticks monitoring data for 266 messages.
2025-08-28 15:17:51,628 | INFO | kafka_consumer | Inserted 5 rows to ticks_db.
2025-08-28 15:17:51,809 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:17:52,622 | INFO | kafka_consumer | Inserted 55 rows to ticks_db.
2025-08-28 15:17:53,671 | INFO | kafka_consumer | Inserted 28 rows to ticks_db.
2025-08-28 15:17:54,609 | INFO | kafka_consumer | Inserted 120 rows to ticks_db.
2025-08-28 15:17:55,612 | INFO | kafka_consumer | Inserted 2 rows to ticks_db.
2025-08-28 15:17:56,374 | INFO | monitoring | Inserted ticks monitoring data for 210 messages.
2025-08-28 15:17:56,614 | INFO | kafka_consumer | Inserted 4 rows to ticks_db.
2025-08-28 15:17:56,855 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:17:58,624 | INFO | kafka_consumer | Inserted 5 rows to ticks_db.
2025-08-28 15:17:59,616 | INFO | kafka_consumer | Inserted 5 rows to ticks_db.
2025-08-28 15:18:00,678 | INFO | kafka_consumer | Inserted 2 rows to ticks_db.
2025-08-28 15:18:01,448 | INFO | monitoring | Inserted ticks monitoring data for 16 messages.
2025-08-28 15:18:01,702 | INFO | kafka_consumer | Inserted 279 rows to ticks_db.
2025-08-28 15:18:01,902 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:02,690 | INFO | kafka_consumer | Inserted 161 rows to ticks_db.
2025-08-28 15:18:03,672 | INFO | kafka_consumer | Inserted 159 rows to ticks_db.
2025-08-28 15:18:04,631 | INFO | kafka_consumer | Inserted 56 rows to ticks_db.
2025-08-28 15:18:05,686 | INFO | kafka_consumer | Inserted 4 rows to ticks_db.
2025-08-28 15:18:06,547 | INFO | monitoring | Inserted ticks monitoring data for 659 messages.
2025-08-28 15:18:06,641 | INFO | kafka_consumer | Inserted 166 rows to ticks_db.
2025-08-28 15:18:06,944 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:07,652 | INFO | kafka_consumer | Inserted 5 rows to ticks_db.
2025-08-28 15:18:08,649 | INFO | kafka_consumer | Inserted 47 rows to ticks_db.
2025-08-28 15:18:09,680 | INFO | kafka_consumer | Inserted 28 rows to ticks_db.
2025-08-28 15:18:10,734 | INFO | kafka_consumer | Inserted 117 rows to ticks_db.
2025-08-28 15:18:11,643 | INFO | monitoring | Inserted ticks monitoring data for 363 messages.
2025-08-28 15:18:11,716 | INFO | kafka_consumer | Inserted 143 rows to ticks_db.
2025-08-28 15:18:11,990 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:12,686 | INFO | kafka_consumer | Inserted 185 rows to ticks_db.
2025-08-28 15:18:13,654 | INFO | kafka_consumer | Inserted 63 rows to ticks_db.
2025-08-28 15:18:14,677 | INFO | kafka_consumer | Inserted 1 rows to ticks_db.
2025-08-28 15:18:15,700 | INFO | kafka_consumer | Inserted 6 rows to ticks_db.
2025-08-28 15:18:16,772 | INFO | kafka_consumer | Inserted 46 rows to ticks_db.
2025-08-28 15:18:16,840 | INFO | monitoring | Inserted ticks monitoring data for 398 messages.
2025-08-28 15:18:17,053 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:17,776 | INFO | kafka_consumer | Inserted 10 rows to ticks_db.
2025-08-28 15:18:18,731 | INFO | kafka_consumer | Inserted 159 rows to ticks_db.
2025-08-28 15:18:19,740 | INFO | kafka_consumer | Inserted 3 rows to ticks_db.
2025-08-28 15:18:20,711 | INFO | kafka_consumer | Inserted 58 rows to ticks_db.
2025-08-28 15:18:21,746 | INFO | kafka_consumer | Inserted 3 rows to ticks_db.
2025-08-28 15:18:21,922 | INFO | monitoring | Inserted ticks monitoring data for 233 messages.
2025-08-28 15:18:22,124 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:22,743 | INFO | kafka_consumer | Inserted 99 rows to ticks_db.
2025-08-28 15:18:23,728 | INFO | kafka_consumer | Inserted 82 rows to ticks_db.
2025-08-28 15:18:24,708 | INFO | kafka_consumer | Inserted 41 rows to ticks_db.
2025-08-28 15:18:25,719 | INFO | kafka_consumer | Inserted 1 rows to ticks_db.
2025-08-28 15:18:27,010 | INFO | monitoring | Inserted ticks monitoring data for 223 messages.
2025-08-28 15:18:27,247 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:27,801 | INFO | kafka_consumer | Inserted 3 rows to ticks_db.
2025-08-28 15:18:28,739 | INFO | kafka_consumer | Inserted 123 rows to ticks_db.
2025-08-28 15:18:29,741 | INFO | kafka_consumer | Inserted 1 rows to ticks_db.
2025-08-28 15:18:30,748 | INFO | kafka_consumer | Inserted 5 rows to ticks_db.
2025-08-28 15:18:31,883 | INFO | kafka_consumer | Inserted 12 rows to ticks_db.
2025-08-28 15:18:32,077 | INFO | monitoring | Inserted ticks monitoring data for 144 messages.
2025-08-28 15:18:32,301 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:32,761 | INFO | kafka_consumer | Inserted 200 rows to ticks_db.
2025-08-28 15:18:33,774 | INFO | kafka_consumer | Inserted 25 rows to ticks_db.
2025-08-28 15:18:34,776 | INFO | kafka_consumer | Inserted 26 rows to ticks_db.
2025-08-28 15:18:35,751 | INFO | kafka_consumer | Inserted 62 rows to ticks_db.
2025-08-28 15:18:36,794 | INFO | kafka_consumer | Inserted 4 rows to ticks_db.
2025-08-28 15:18:37,157 | INFO | monitoring | Inserted ticks monitoring data for 317 messages.
2025-08-28 15:18:37,354 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:37,820 | INFO | kafka_consumer | Inserted 84 rows to ticks_db.
2025-08-28 15:18:38,787 | INFO | kafka_consumer | Inserted 187 rows to ticks_db.
2025-08-28 15:18:39,787 | INFO | kafka_consumer | Inserted 56 rows to ticks_db.
2025-08-28 15:18:40,787 | INFO | kafka_consumer | Inserted 67 rows to ticks_db.
2025-08-28 15:18:41,782 | INFO | kafka_consumer | Inserted 57 rows to ticks_db.
2025-08-28 15:18:42,262 | INFO | monitoring | Inserted ticks monitoring data for 451 messages.
2025-08-28 15:18:42,432 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:42,791 | INFO | kafka_consumer | Inserted 2 rows to ticks_db.
2025-08-28 15:18:43,787 | INFO | kafka_consumer | Inserted 7 rows to ticks_db.
2025-08-28 15:18:44,786 | INFO | kafka_consumer | Inserted 3 rows to ticks_db.
2025-08-28 15:18:45,794 | INFO | kafka_consumer | Inserted 7 rows to ticks_db.
2025-08-28 15:18:46,809 | INFO | kafka_consumer | Inserted 23 rows to ticks_db.
2025-08-28 15:18:47,324 | INFO | monitoring | Inserted ticks monitoring data for 42 messages.
2025-08-28 15:18:47,496 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:47,805 | INFO | kafka_consumer | Inserted 20 rows to ticks_db.
2025-08-28 15:18:48,838 | INFO | kafka_consumer | Inserted 4 rows to ticks_db.
2025-08-28 15:18:49,876 | INFO | kafka_consumer | Inserted 78 rows to ticks_db.
2025-08-28 15:18:50,919 | INFO | kafka_consumer | Inserted 123 rows to ticks_db.
2025-08-28 15:18:51,005 | INFO | kafka_consumer | Inserted 300 rows to ticks_db.
2025-08-28 15:18:51,843 | INFO | kafka_consumer | Inserted 16 rows to ticks_db.
2025-08-28 15:18:52,419 | INFO | monitoring | Inserted ticks monitoring data for 541 messages.
2025-08-28 15:18:52,551 | INFO | monitoring | Completed a monitoring cycle.
2025-08-28 15:18:52,857 | INFO | kafka_consumer | Inserted 18 rows to ticks_db.
2025-08-28 15:18:53,833 | INFO | kafka_consumer | Inserted 44 rows to ticks_db.
